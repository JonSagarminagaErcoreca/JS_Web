<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Corner</title>

  <!-- Global (menú, tipografías, utilidades) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles/global.css">

  <!-- Estilos específicos de esta página con mayor especificidad -->
  <style>
    /* ===== Página AI ===== */
    body[data-page="ai"] { padding: 0; margin: 0; background: #0a0a0b; overflow: hidden; width: 100%; height: 100dvh; }
    body[data-page="ai"] main { height: 100dvh; width: 100%; padding: 8px; overflow: hidden; box-sizing: border-box; }
    
    /* Navegación flotante sobre la grid */
    body[data-page="ai"] .site-nav { z-index: 10; }

    /* ===== GRID (misma estética de antes, ahora namespaced) ===== */
    body[data-page="ai"] .grid { display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(6, 1fr); gap: 8px; height: 100%; width: 100%; margin: 0; padding: 0; grid-auto-flow: dense; }

    body[data-page="ai"] .card {
      position: relative;
      overflow: hidden;
      border-radius: 16px;
      background: #0b0b0c;
      color: #fafafa;
      cursor: pointer;
      display: block;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      transition: transform 0.35s cubic-bezier(.2,.6,.2,1), box-shadow 0.35s cubic-bezier(.2,.6,.2,1);
    }

    body[data-page="ai"] .card.xl { grid-column: span 8; grid-row: span 4; }
    body[data-page="ai"] .card.large { grid-column: span 4; grid-row: span 3; }
    body[data-page="ai"] .card.medium { grid-column: span 4; grid-row: span 2; }
    body[data-page="ai"] .card.small { grid-column: span 4; grid-row: span 2; }

    body[data-page="ai"] .card:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: 0 18px 50px rgba(0,0,0,0.25);
    }

    body[data-page="ai"] .card-media { position: relative; background: #111; height: 100%; }
    body[data-page="ai"] .card-media img {
      width: 100%; height: 100%; object-fit: cover; display: block;
      filter: saturate(1.05) contrast(1.05);
      transform: scale(1.02);
      transition: transform 0.5s cubic-bezier(.2,.7,.2,1), filter 0.35s ease;
    }
    body[data-page="ai"] .card:hover .card-media img { transform: scale(1.06); filter: blur(12px) brightness(0.4) saturate(0.5); }

    body[data-page="ai"] .card-gradient {
      position: absolute; inset: 0;
      background:
        radial-gradient(120% 120% at 50% 10%, rgba(255,255,255,0.16), rgba(0,0,0,0.2)),
        linear-gradient(180deg, rgba(0,0,0,0) 40%, rgba(0,0,0,0.55));
      pointer-events: none;
    }
    /* Overlay de información (3 filas: título, subtítulo, iconos) */
    body[data-page="ai"] .card-overlay { position:absolute; inset:0; display:grid; grid-template-rows:auto auto auto; align-content:end; justify-items:start; gap:8px; padding:20px; text-align:left; opacity:0; transform: translateY(20px); transition: opacity .25s ease, transform .25s ease; }
    body[data-page="ai"] .card:hover .card-overlay { opacity:1; transform: translateY(0); }
    body[data-page="ai"] .card-overlay h3 { margin:0; font-size:20px; font-weight:700; letter-spacing:-0.01em; }
    body[data-page="ai"] .card-overlay p { margin:0; font-size:14px; color:#c2c6cf; }
    body[data-page="ai"] .card-overlay .icons { display:flex; gap:10px; align-items:center; justify-content:flex-start; margin-top:4px; }
    body[data-page="ai"] .card-overlay .icons svg { width:18px; height:18px; opacity:.95; filter: drop-shadow(0 2px 6px rgba(0,0,0,.35)); }

    /* ===== MODAL (namespaced) ===== */
    body[data-page="ai"] .modal-backdrop {
      position: fixed; inset: 0; display: grid; place-items: center;
      background: rgba(12,12,14,0.35);
      backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
      opacity: 0; pointer-events: none; transition: opacity 0.25s ease; z-index: 2000;
    }
    body[data-page="ai"] .modal-backdrop[aria-hidden="false"] { opacity: 1; pointer-events: auto; }

    body[data-page="ai"] .modal {
      width: min(820px, 90%);
      max-height: 90vh;
      border-radius: 18px;
      overflow: auto;
      background: #0e0f12; color: #f3f4f6;
      box-shadow: 0 30px 80px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.06);
      transform: translateY(16px) scale(0.98); opacity: 0;
      transition: transform 0.35s cubic-bezier(.2,.7,.2,1), opacity 0.35s ease;
      padding: 24px; position: relative;
    }
    body[data-page="ai"] .modal-backdrop[aria-hidden="false"] .modal { transform: translateY(0) scale(1); opacity: 1; }
    body[data-page="ai"] .modal h2 { margin-top: 0; }
    body[data-page="ai"] .modal img { width: 100%; border-radius: 12px; margin-bottom: 16px; }
    body[data-page="ai"] .modal-close {
      position: absolute; top: 16px; right: 16px;
      background: transparent; border: none; color: #fff; font-size: 28px; cursor: pointer;
    }

    /* ===== Responsive ===== */
    @media (max-width: 980px) {
      body[data-page="ai"] .grid { grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(8, 1fr); }
      body[data-page="ai"] .card.xl { grid-column: span 6; grid-row: span 4; }
      body[data-page="ai"] .card.large { grid-column: span 6; grid-row: span 3; }
      body[data-page="ai"] .card.medium { grid-column: span 3; grid-row: span 2; }
      body[data-page="ai"] .card.small { grid-column: span 3; grid-row: span 1; }
    }
    @media (max-width: 560px) {
      body[data-page="ai"] main { padding: 6px; }
      body[data-page="ai"] .grid { gap: 6px; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(12, 1fr); }
      body[data-page="ai"] .card.xl { grid-column: span 4; grid-row: span 5; }
      body[data-page="ai"] .card.large { grid-column: span 4; grid-row: span 4; }
      body[data-page="ai"] .card.medium { grid-column: span 4; grid-row: span 2; }
      body[data-page="ai"] .card.small { grid-column: span 4; grid-row: span 1; }
    }

    /* AI page: asegúrate de que la grid ocupa todo el ancho y alto */
    body[data-page="ai"] {
      background: #0a0a0b;
      overflow: hidden;
      width: 100%;
      height: 100dvh;
    }

    body[data-page="ai"] main {
      height: 100dvh;     /* ocupa todo el viewport */
      width: 100%;
      padding: 16px;      /* si quieres menos "aire", baja este valor, p. ej. 12px */
      box-sizing: border-box;
      overflow: hidden;
    }

    /* La grid: full-bleed, sin max-width ni márgenes centrados */
    body[data-page="ai"] .grid {
      margin: 0 !important;
      max-width: none !important;
      width: 100%;
      height: 100%;
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(12, 1fr);
      grid-template-rows: repeat(6, 1fr);
      grid-auto-flow: dense; /* rellena huecos si puede */
    }

    /* Evita "saltos" de imagen inline y problemas de encogimiento */
    body[data-page="ai"] .card { min-width: 0; min-height: 0; }
    body[data-page="ai"] .card-media img { display: block; width: 100%; height: 100%; object-fit: cover; }

    /* 1ª fila completa: 8 + 4 */
    body[data-page="ai"] .grid > .card:nth-child(1) {  /* Prompt → Palette (grande) */
      grid-column: 1 / span 8;
      grid-row: 1 / span 3;
    }
    body[data-page="ai"] .grid > .card:nth-child(2) {  /* Vectorize Anything */
      grid-column: 9 / span 4;
      grid-row: 1 / span 3;
    }

    /* 2ª fila completa: 4 + 8 */
    body[data-page="ai"] .grid > .card:nth-child(3) {  /* AI Storyboards */
      grid-column: 1 / span 4;
      grid-row: 4 / span 3;
    }
    body[data-page="ai"] .grid > .card:nth-child(4) {  /* Voice → Notes (grande) */
      grid-column: 5 / span 8;   /* ocupa de la col 5 a la 12 */
      grid-row: 4 / span 3;
    }

    /* ===== Expandable Grid (add-on) ===== */
    body[data-page="ai"] .grid {
      grid-auto-flow: dense;              /* empaqueta huecos automáticamente */
      transition: grid-gap .25s ease;
    }

    body[data-page="ai"] .card {
      /* spans controlados por variables, con transición suave */
      --col-span: 3;                      /* base: como ya tenías */
      --row-span: 1;
      grid-column: span var(--col-span);
      grid-row: span var(--row-span);
      transition:
        transform .35s cubic-bezier(.2,.6,.2,1),
        box-shadow .35s cubic-bezier(.2,.6,.2,1),
        filter .25s ease,
        opacity .25s ease;
      position: relative;
      isolation: isolate;
    }

    /* tus "large" siguen funcionando igual */
    body[data-page="ai"] .card.large { --col-span: 6; --row-span: 1; }

    /* Estado expandido de UNA card */
    body[data-page="ai"] .card.is-expanded {
      --col-span: 8;                      /* ocupa 8/12 columnas */
      --row-span: 2;                      /* y 2 filas (toda la altura del grid) */
      z-index: 3;
      transform: translateY(-2px) scale(1.01);
      box-shadow: 0 22px 60px rgba(0,0,0,.35);
    }

    /* El resto se encoge pero quedan visibles y rellenan el grid */
    body[data-page="ai"] .grid.has-expanded .card:not(.is-expanded) {
      --col-span: 2;                      /* mínimo 2 columnas */
      --row-span: 1;                      /* 1 fila (mínimo de alto) */
      opacity: .95;
      filter: saturate(.9) contrast(.95) brightness(.96);
      transform: scale(.985);
    }

    /* Contenidos extra: solo visibles al expandir */
    body[data-page="ai"] .card-extra {
      display: none;
      opacity: 0;
      transition: opacity .25s ease;
    }
    body[data-page="ai"] .card.is-expanded .card-extra {
      display: block;
      opacity: 1;
    }

    body[data-page="ai"] .card.is-expanded .card-body {
      /* un poco más de aire al texto al expandir */
      padding: 18px 18px 20px;
    }

    /* Mini-galería dentro de la expandida */
    body[data-page="ai"] .gallery {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      padding-bottom: 6px;
      margin-top: 10px;
    }
    body[data-page="ai"] .gallery img {
      height: 120px;
      min-width: 200px;
      object-fit: cover;
      border-radius: 10px;
      scroll-snap-align: start;
    }

      /* Responsivo: en pantallas estrechas la expandida ocupa todo */
      @media (max-width: 980px) {
        body[data-page="ai"] .card.is-expanded { --col-span: 12; --row-span: 2; }
        body[data-page="ai"] .grid.has-expanded .card:not(.is-expanded) { --col-span: 6; }
      }
      @media (max-width: 560px) {
        body[data-page="ai"] .card.is-expanded { --col-span: 4; --row-span: 2; }
        body[data-page="ai"] .grid.has-expanded .card:not(.is-expanded) { --col-span: 4; }
      }

      /* ===== EXPAND FIX: anular posiciones fijas cuando haya una expandida ===== */

      /* Valores por defecto de las variables (sirven solo en modo expandido) */
      body[data-page="ai"] .card {
        --col-span: 4;   /* base en expand mode */
        --row-span: 2;
      }

      /* Cuando hay una expandida, TODOS los items dejan de usar las posiciones fijas
         y pasan a usar únicamente los span por variables */
      body[data-page="ai"] .grid.has-expanded > .card {
        grid-column: span var(--col-span) !important;
        grid-row: span var(--row-span) !important;
      }

      /* La expandida crece */
      body[data-page="ai"] .grid.has-expanded > .card.is-expanded {
        --col-span: 8;   /* ocupa ~2/3 del ancho (12 columnas totales) */
        --row-span: 4;   /* más alto; tu grid tiene 6 filas */
        z-index: 3;
        transform: translateY(-2px) scale(1.01);
        box-shadow: 0 22px 60px rgba(0,0,0,.35);
      }

      /* Las no-expandidas se encogen pero siguen visibles (mínimo 2×2) */
      body[data-page="ai"] .grid.has-expanded > .card:not(.is-expanded) {
        --col-span: 2;
        --row-span: 2;
        opacity: .96;
        filter: saturate(.9) contrast(.95) brightness(.96);
        transform: scale(.985);
      }

      /* No difuminar la imagen de la expandida */
      body[data-page="ai"] .card.is-expanded .card-media img {
        filter: none !important;
        transform: scale(1.02);
      }

      /* Mostrar contenido extra solo en expandida (ya lo tenías, lo refuerzo) */
      body[data-page="ai"] .card-extra { display: none; opacity: 0; transition: opacity .25s ease; }
      body[data-page="ai"] .card.is-expanded .card-extra { display: block; opacity: 1; }

      /* Responsivo opcional del expand:
         - En tablet que la expandida ocupe todo el ancho.
         - En móvil no usamos expand (tu JS ya lo evita), pero lo dejo por si fuerza. */
      @media (max-width: 980px) {
        body[data-page="ai"] .grid.has-expanded > .card.is-expanded { --col-span: 12; --row-span: 4; }
        body[data-page="ai"] .grid.has-expanded > .card:not(.is-expanded) { --col-span: 6; --row-span: 2; }
      }
      @media (max-width: 560px) {
        body[data-page="ai"] .grid.has-expanded > .card.is-expanded { --col-span: 4; --row-span: 3; }
        body[data-page="ai"] .grid.has-expanded > .card:not(.is-expanded) { --col-span: 4; --row-span: 2; }
      }

      /* === GRID EXPANDIBLE – LAYOUTS POR ESTADO === */

      /* El grid base ya lo tienes. Añadimos estados del grid
         con data-state en el contenedor .grid */
      body[data-page="ai"] .grid {
        position: relative;
        contain: layout paint style; /* rendimiento */
      }

      /* --- Base (ya lo tienes) ---
         1: 8x3   2: 4x3
         3: 4x3   4: 8x3
      */
      body[data-page="ai"] .grid > .card:nth-child(1) { grid-column: 1 / span 8; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid > .card:nth-child(2) { grid-column: 9 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid > .card:nth-child(3) { grid-column: 1 / span 4; grid-row: 4 / span 3; }
      body[data-page="ai"] .grid > .card:nth-child(4) { grid-column: 5 / span 8; grid-row: 4 / span 3; }

      /* Cards encogidas cuando hay expandida */
      body[data-page="ai"] .grid[data-state^="expand-"] > .card {
        transition: transform .35s cubic-bezier(.2,.7,.2,1), filter .25s ease, opacity .25s ease;
        will-change: transform, filter;
      }
      body[data-page="ai"] .grid[data-state^="expand-"] > .card:not(.is-expanded) {
        transform: scale(.96);
        filter: brightness(.95) contrast(.95) saturate(.95);
      }

      /* Contenido extra: visible solo en expandida */
      body[data-page="ai"] .card .card-extra { display: none; opacity: 0; transition: opacity .25s ease; }
      body[data-page="ai"] .card.is-expanded .card-extra { display: block; opacity: 1; }
      body[data-page="ai"] .card.is-expanded .card-body { padding: 18px; }

      /* === Disposiciones por card expandida (12x6) === */
      /* 1) Expande la #1 (grande a la izquierda, columna de pequeñas a la derecha) */
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(1) { grid-column: 1 / span 8; grid-row: 1 / span 6; }
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(2) { grid-column: 9 / span 4; grid-row: 1 / span 2; }
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(3) { grid-column: 9 / span 4; grid-row: 3 / span 2; }
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(4) { grid-column: 9 / span 4; grid-row: 5 / span 2; }

      /* 2) Expande la #2 (grande a la derecha, columna de pequeñas a la izquierda) */
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(2) { grid-column: 5 / span 8; grid-row: 1 / span 6; }
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(1) { grid-column: 1 / span 4; grid-row: 1 / span 2; }
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(3) { grid-column: 1 / span 4; grid-row: 3 / span 2; }
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(4) { grid-column: 1 / span 4; grid-row: 5 / span 2; }

      /* 3) Expande la #3 (grande abajo-izq, pequeñas columna derecha) */
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(3) { grid-column: 1 / span 8; grid-row: 1 / span 6; }
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(1) { grid-column: 9 / span 4; grid-row: 1 / span 2; }
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(2) { grid-column: 9 / span 4; grid-row: 3 / span 2; }
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(4) { grid-column: 9 / span 4; grid-row: 5 / span 2; }

      /* 4) Expande la #4 (grande abajo-der, pequeñas columna izquierda) */
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(4) { grid-column: 5 / span 8; grid-row: 1 / span 6; }
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(1) { grid-column: 1 / span 4; grid-row: 1 / span 2; }
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(2) { grid-column: 1 / span 4; grid-row: 3 / span 2; }
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(3) { grid-column: 1 / span 4; grid-row: 5 / span 2; }

      /* Tablet: mantenemos la idea, pero con 6 columnas */
      @media (max-width: 980px) and (min-width: 560px) {
        /* base compacta */
        body[data-page="ai"] .grid { grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(8, 1fr); }
        body[data-page="ai"] .grid > .card:nth-child(1) { grid-column: 1 / span 4; grid-row: 1 / span 3; }
        body[data-page="ai"] .grid > .card:nth-child(2) { grid-column: 5 / span 2; grid-row: 1 / span 3; }
        body[data-page="ai"] .grid > .card:nth-child(3) { grid-column: 1 / span 2; grid-row: 4 / span 3; }
        body[data-page="ai"] .grid > .card:nth-child(4) { grid-column: 3 / span 4; grid-row: 4 / span 3; }

        /* expand-1 */
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(1) { grid-column: 1 / span 4; grid-row: 1 / span 8; }
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(2) { grid-column: 5 / span 2; grid-row: 1 / span 3; }
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(3) { grid-column: 5 / span 2; grid-row: 4 / span 2; }
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(4) { grid-column: 5 / span 2; grid-row: 6 / span 3; }

        /* expand-2 */
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(2) { grid-column: 2 / span 5; grid-row: 1 / span 8; }
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(1) { grid-column: 1 / span 1; grid-row: 1 / span 3; }
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(3) { grid-column: 1 / span 1; grid-row: 4 / span 2; }
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(4) { grid-column: 1 / span 1; grid-row: 6 / span 3; }

        /* expand-3 */
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(3) { grid-column: 1 / span 4; grid-row: 1 / span 8; }
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(1) { grid-column: 5 / span 2; grid-row: 1 / span 3; }
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(2) { grid-column: 5 / span 2; grid-row: 4 / span 2; }
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(4) { grid-column: 5 / span 2; grid-row: 6 / span 3; }

        /* expand-4 */
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(4) { grid-column: 2 / span 5; grid-row: 1 / span 8; }
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(1) { grid-column: 1 / span 1; grid-row: 1 / span 3; }
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(2) { grid-column: 1 / span 1; grid-row: 4 / span 2; }
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(3) { grid-column: 1 / span 1; grid-row: 6 / span 3; }
      }

      /* En móvil seguimos usando tu modal — no expandimos dentro del grid */
  </style>
</head>

<body data-page="ai">
  <!-- ===== NAV (igual que about.html) ===== -->
  <nav class="site-nav">
    <div class="nav-inner">
      <div class="menu-bar">
        <a class="menu-logo" href="./index.html">
          <img src="assets/cursors/JS_GRIS.svg" alt="JS" />
          <span class="logo-mask" aria-hidden="true"></span>
        </a>

        <button class="menu-toggle" id="menuToggle" aria-label="Open menu">
          <input type="checkbox" aria-hidden="true" tabindex="-1" />
          <div class="bars"><span></span><span></span></div>
        </button>
      </div>
      <div class="right-links"></div>
    </div>
  </nav>

  <div class="menu-overlay" id="menuOverlay" aria-hidden="true">
    <div class="menu-panel" id="menuPanel">
      <nav class="menu-links" aria-label="Primary">
        <a href="./work.html">Work</a>
        <a href="./about.html">About</a>
        <a href="./ai-corner.html">AI Lab</a>
      </nav>
    </div>
  </div>

  <!-- ===== GRID ===== -->
  <main>
    <section class="grid" aria-label="AI Experiments grid" id="aiGrid">
      <!-- Card 1 -->
      <article class="card large" data-id="palette">
        <div class="card-media">
          <img src="assets/JS_Portrait.png" alt="Abstract gradient generated by AI" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <h3>Prompt → Palette</h3>
          <p>Convierte prompts en paletas cromáticas.</p>
          <div class="icons" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3 7h7l-5.5 4 2 7-6.5-4.5L5.5 20l2-7L2 9h7z"/></svg>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 12l18-9-9 18-2-7z"/></svg>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 4h10v2H7zm0 7h10v2H7zm0 7h10v2H7z"/></svg>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title">Prompt → Palette</h3>
          <p class="card-desc">Convierte prompts en paletas cromáticas.</p>

          <!-- SOLO visible cuando la card está expandida -->
          <div class="card-extra">
            <p>Genera armonías, comprueba contraste AA/AAA y exporta variantes para UI. Pensado para flujos rápidos de diseño.</p>
            <div class="gallery" aria-label="Galería">
              <img src="assets/cursors/cursor6.png" alt="Preview 1">
              <img src="assets/cursors/cursor9.png" alt="Preview 2">
              <img src="assets/cursors/cursor12.png" alt="Preview 3">
            </div>
          </div>
        </div>
      </article>

      <!-- Card 2 -->
      <article class="card" data-id="vectorize">
        <div class="card-media">
          <img src="assets/cursors/cursor6.png" alt="Vector style preview" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <h3>Vectorize Anything</h3>
          <p>Embellece bocetos a SVG limpios.</p>
          <div class="icons" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M5 3h14v2H5zm0 8h14v2H5zm0 8h14v2H5z"/></svg>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 100 20 10 10 0 000-20z"/></svg>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16v16H4z"/></svg>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title">Vectorize Anything</h3>
          <p class="card-desc">Embellece bocetos a SVG limpios.</p>
          <div class="card-extra">
            <p>De sketch a vector de producción con líneas suaves y menos puntos. Ideal para iconos y logotipos rápidos.</p>
            <div class="gallery">
              <img src="assets/cursors/cursor12.png" alt="Preview">
              <img src="assets/cursors/cursor9.png" alt="Preview">
            </div>
          </div>
        </div>
      </article>

      <!-- Card 3 -->
      <article class="card" data-id="storyboards">
        <div class="card-media">
          <img src="assets/cursors/cursor9.png" alt="Storyboard frames" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <h3>AI Storyboards</h3>
          <p>Genera secuencias para pitch visual.</p>
          <div class="icons" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 6h16v12H4z"/></svg>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 7l5 10H7z"/></svg>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title">AI Storyboards</h3>
          <p class="card-desc">Genera secuencias para pitch visual.</p>
          <div class="card-extra">
            <p>Coherencia estilística entre planos, prompts orientados a narrativa y export para presentación.</p>
            <div class="gallery">
              <img src="assets/cursors/cursor6.png" alt="Preview">
              <img src="assets/cursors/cursor12.png" alt="Preview">
            </div>
          </div>
        </div>
      </article>

      <!-- Card 4 -->
      <article class="card large" data-id="voice-notes">
        <div class="card-media">
          <img src="assets/cursors/cursor12.png" alt="Waveform visualization" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <h3>Voice → Notes</h3>
          <p>Transcribe y resume ideas.</p>
          <div class="icons" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3a3 3 0 013 3v6a3 3 0 11-6 0V6a3 3 0 013-3zM5 11h2a5 5 0 0010 0h2a7 7 0 01-14 0zM10 19h4v2h-4z"/></svg>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 5v14M5 12h14"/></svg>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16v16H4z"/></svg>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title">Voice → Notes</h3>
          <p class="card-desc">Transcribe y resume ideas.</p>
          <div class="card-extra">
            <p>ASR + resumidores + etiquetas clave. Export a docs o tickets. Perfecto para ideas en movimiento.</p>
            <div class="gallery">
              <img src="assets/cursors/cursor9.png" alt="Preview">
              <img src="assets/cursors/cursor6.png" alt="Preview">
            </div>
          </div>
        </div>
      </article>
    </section>
  </main>

  <!-- ===== MODAL ===== -->
  <div class="modal-backdrop" aria-hidden="true">
    <div class="modal">
      <button class="modal-close" aria-label="Close">&times;</button>
      <h2>Título del proyecto</h2>
      <img src="" alt="" hidden>
      <p>Aquí irá más información detallada del proyecto seleccionado.</p>
    </div>
  </div>

  <!-- ===== JS menú (igual que about) + modal dinámico ===== -->
  <script>
    (function(){
      const toggle = document.getElementById('menuToggle');
      const overlay = document.getElementById('menuOverlay');
      const panel = document.getElementById('menuPanel');
      const bar = document.querySelector('.menu-bar');
      const logo = document.querySelector('.menu-logo');
      const logoImg = logo?.querySelector('img');
      const logoMask = logo?.querySelector('.logo-mask');

      if (toggle && overlay) {
        const setOpen = (open) => {
          overlay.classList.toggle('open', open);
          overlay.setAttribute('aria-hidden', String(!open));
          document.body.style.overflow = open ? 'hidden' : '';
        };
        const positionPanel = () => {
          if (!bar || !panel) return;
          const rect = bar.getBoundingClientRect();
          const top = rect.bottom + 24 + window.scrollY;
          panel.style.top = top + 'px';
          panel.style.left = '';
          panel.style.transform = '';
        };
        toggle.addEventListener('click', (e) => {
          e.preventDefault();
          const checkbox = toggle.querySelector('input');
          const open = checkbox ? !checkbox.checked : !overlay.classList.contains('open');
          setOpen(open);
          toggle.classList.toggle('open', open);
          if (checkbox) checkbox.checked = open;
          if (open) positionPanel();
        });
        const closeAndReset = () => {
          setOpen(false);
          toggle.classList.remove('open');
          const c = toggle.querySelector('input');
          if (c) c.checked = false;
        };
        overlay.addEventListener('click', (e) => { if (e.target === overlay) closeAndReset(); });
        overlay.querySelectorAll('a').forEach(a => a.addEventListener('click', closeAndReset));
        window.addEventListener('resize', () => { if (overlay.classList.contains('open')) positionPanel(); });
      }

      function randomGradient(){
        const h = Math.floor(Math.random()*360);
        const h2 = (h+60)%360;
        return `linear-gradient(135deg, hsl(${h} 80% 65%), hsl(${h2} 80% 65%))`;
      }
      function applyRandomGradient(){
        if (!logoMask || !logoImg) return;
        logoMask.style.background = randomGradient();
        logoMask.classList.add('gradient');
        logoImg.style.opacity = '0';
      }
      function removeGradient(){
        if (!logoMask || !logoImg) return;
        logoMask.classList.remove('gradient');
        logoImg.style.opacity = '1';
      }
      logo?.addEventListener('mouseenter', applyRandomGradient);
      logo?.addEventListener('mouseleave', removeGradient);
    })();

    /* ===== COMENTADO: Sistema anterior de expansión ===== */
    /*
    (function () {
      // ------- helpers modal -------
      const backdrop = document.querySelector('.modal-backdrop');
      const modal    = backdrop?.querySelector('.modal');
      const closeBtn = modal?.querySelector('.modal-close');
      const h2       = modal?.querySelector('h2');
      const p        = modal?.querySelector('p');
      const img      = modal?.querySelector('img');

      const openModal = ({ title, desc, image }) => {
        if (!backdrop) return;
        if (h2)  h2.textContent = title || 'Proyecto';
        if (p)   p.textContent  = desc  || '';
        if (img) {
          if (image) { img.src = image; img.alt = title || ''; img.hidden = false; }
          else { img.hidden = true; }
        }
        backdrop.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
      };

      const closeModal = () => {
        if (!backdrop) return;
        backdrop.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
      };

      closeBtn?.addEventListener('click', closeModal);
      backdrop?.addEventListener('click', (e) => { if (e.target === backdrop) closeModal(); });
      window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

      // ------- expand/collapse -------
      const grid  = document.getElementById('aiGrid');
      const cards = grid ? Array.from(grid.querySelectorAll('.card')) : [];

      const collapseAll = () => {
        grid?.classList.remove('has-expanded');
        cards.forEach(c => c.classList.remove('is-expanded'));
      };

      // ------- selector de modo por width -------
      const mqMobile = window.matchMedia('(max-width: 560px)');

      function attachHandlers() {
        // Limpia listeners antiguos si recargas esta función
        cards.forEach(card => {
          const clone = card.cloneNode(true);
          card.parentNode.replaceChild(clone, card);
        });
        // Vuelve a capturar la lista actualizada
        const freshCards = Array.from(grid.querySelectorAll('.card'));

        freshCards.forEach(card => {
          // Datos para el modal (si no hay data-*, se toman del DOM)
          const getModalData = () => ({
            title: card.dataset.title || card.querySelector('.card-title')?.textContent || 'Proyecto',
            desc : card.dataset.desc  || card.querySelector('.card-desc')?.textContent  || '',
            image: card.dataset.image || card.querySelector('.card-media img')?.getAttribute('src') || ''
          });

          if (mqMobile.matches) {
            // ----- MÓVIL: solo modal -----
            card.addEventListener('click', () => {
              // por si quedaba algo expandido desde un resize
              collapseAll();
              openModal(getModalData());
            });
          } else {
            // ----- DESKTOP/TABLET: solo expandir -----
            card.addEventListener('click', (e) => {
              // no colapsar al interactuar con carruseles dentro
              if (e.target.closest('.gallery')) return;

              const isOpen = card.classList.contains('is-expanded');
              if (isOpen) {
                collapseAll();
              } else {
                freshCards.forEach(c => c.classList.remove('is-expanded'));
                card.classList.add('is-expanded');
                grid.classList.add('has-expanded');
                card.scrollIntoView({ block: 'nearest', inline: 'nearest', behavior: 'smooth' });
              }
            });
          }
        });
      }

      // Ejecutar al cargar
      if (grid && cards.length) attachHandlers();

      // Reaplicar cuando cambie el breakpoint
      mqMobile.addEventListener('change', () => {
        collapseAll();
        attachHandlers();
      });

      // Opcional: al redimensionar muy grande/pequeño, rearmar
      window.addEventListener('resize', () => {
        // nada agresivo, solo asegurar estado coherente
        if (mqMobile.matches) collapseAll();
      });
    })();
    */

    /* ===== NUEVO SISTEMA DE EXPANSIÓN CON FLIP ===== */
    (function(){
      const grid   = document.getElementById('aiGrid');
      if (!grid) return;

      const mqMobile = window.matchMedia('(max-width: 560px)');

      // Estado base
      function setBaseState(){
        grid.dataset.state = 'base';
        grid.querySelectorAll('.card.is-expanded').forEach(c => c.classList.remove('is-expanded'));
      }

      // Qué estado aplicar según card index (1..4)
      function stateForIndex(idx){
        return `expand-${idx}`;
      }

      // FLIP: anima todas las cards de su rect old -> rect new
      function animateFlip(beforeRects, duration = 400){
        const cards = [...grid.querySelectorAll('.card')];
        cards.forEach((el, i) => {
          const before = beforeRects.get(el);
          if (!before) return;
          const after = el.getBoundingClientRect();

          const dx = before.left - after.left;
          const dy = before.top  - after.top;
          const sx = before.width  / after.width;
          const sy = before.height / after.height;

          el.animate(
            [
              { transform: `translate(${dx}px, ${dy}px) scale(${sx}, ${sy})` },
              { transform: 'translate(0,0) scale(1,1)' }
            ],
            { duration, easing: 'cubic-bezier(.2,.7,.2,1)', fill: 'both' }
          );
        });
      }

      // Manejar click en desktop/tablet
      function onCardClickDesktop(card, index){
        const wasExpanded = card.classList.contains('is-expanded');
        const beforeRects = new Map();
        grid.querySelectorAll('.card').forEach(el => beforeRects.set(el, el.getBoundingClientRect()));

        if (wasExpanded) {
          // volver a base
          setBaseState();
        } else {
          grid.dataset.state = stateForIndex(index + 1); // index 0..3 => expand-1..4
          grid.querySelectorAll('.card').forEach(el => el.classList.remove('is-expanded'));
          card.classList.add('is-expanded');
        }

        // Forzar reflow y animar
        grid.getBoundingClientRect();
        animateFlip(beforeRects, 420);
      }

      // Modal móvil (reusa lo que ya tienes: disparo un custom event)
      function onCardClickMobile(card){
        const ev = new CustomEvent('open-ai-modal', { bubbles:true, detail:{card} });
        card.dispatchEvent(ev);
      }

      // Atar listeners
      function bind(){
        const cards = [...grid.querySelectorAll('.card')];

        // Limpia listeners clonando
        cards.forEach(card => {
          const clone = card.cloneNode(true);
          card.parentNode.replaceChild(clone, card);
        });

        const fresh = [...grid.querySelectorAll('.card')];
        fresh.forEach((card, idx) => {
          if (mqMobile.matches) {
            card.addEventListener('click', () => onCardClickMobile(card));
          } else {
            card.addEventListener('click', (e) => {
              if (e.target.closest('.gallery')) return; // no colapsar por usar la galería
              onCardClickDesktop(card, idx);
            });
          }
        });
      }

      // Inicializa
      setBaseState();
      bind();

      // Re-bind cuando cambia breakpoint
      mqMobile.addEventListener('change', () => {
        setBaseState();
        bind();
      });

      // Si redimensionan mucho, vuelve a base para evitar estados raros
      window.addEventListener('resize', () => {
        if (mqMobile.matches) setBaseState();
      });
    })();
  </script>
</body>
</html>
