<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Corner</title>

  <!-- Global (menú, tipografías, utilidades) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles/global.css">
  <script defer src="./scripts/i18n.js"></script>

  <!-- Protección de acceso -->
  <script>
    (function() {
      const AUTH_KEY = 'portfolio_authenticated';
      const AUTH_TIMESTAMP = 'portfolio_auth_timestamp';
      const SESSION_DURATION = 24 * 60 * 60 * 1000; // 24 horas
      
      function isAuthenticated() {
        const auth = sessionStorage.getItem(AUTH_KEY);
        const timestamp = sessionStorage.getItem(AUTH_TIMESTAMP);
        
        if (!auth || !timestamp) return false;
        
        const now = Date.now();
        const authTime = parseInt(timestamp, 10);
        
        if (now - authTime > SESSION_DURATION) {
          sessionStorage.removeItem(AUTH_KEY);
          sessionStorage.removeItem(AUTH_TIMESTAMP);
          return false;
        }
        
        return auth === 'true';
      }
      
      if (!isAuthenticated()) {
        window.location.href = './password.html';
      }
    })();
  </script>

  <!-- Estilos específicos de esta página con mayor especificidad -->
  <style>
    /* ===== OPTIMIZACIONES DE RENDIMIENTO ===== */
    body[data-page="ai"] .grid {
      contain: layout paint style;
      content-visibility: auto;
    }

    body[data-page="ai"] .card {
      contain: layout paint style;
    }

    body[data-page="ai"] .card:not(:hover):not(.is-expanded) {
      will-change: auto;
    }

    body[data-page="ai"] .card-media {
      contain: layout paint;
    }

    /* Optimizar filtros - solo aplicar will-change en hover */
    body[data-page="ai"] .card-media img {
      will-change: auto;
    }

    body[data-page="ai"] .card:hover .card-media img {
      will-change: filter, transform;
    }

    /* ===== Página AI ===== */
    body[data-page="ai"] { padding: 0; margin: 0; overflow: hidden; width: 100%; height: 100dvh; background: var(--bg); }
    body[data-page="ai"] main { height: 100dvh; width: 100%; padding: 8px; overflow: hidden; box-sizing: border-box; }
    
    /* Navegación flotante sobre la grid */
    body[data-page="ai"] .site-nav { z-index: 10; }

    /* ===== GRID (misma estética de antes, ahora namespaced) ===== */
    body[data-page="ai"] .grid { 
      display: grid; 
      grid-template-columns: repeat(12, 1fr); 
      grid-template-rows: repeat(6, 1fr); 
      gap: 8px; 
      height: 100%; 
      width: 100%; 
      margin: 0; 
      padding: 0; 
      grid-auto-flow: dense;
      overflow: visible;
    }
    
    /* Asegurar que el grid en estado expandido mantenga todas las cards visibles */
    body[data-page="ai"] .grid[data-state^="expand-"] {
      grid-template-rows: repeat(12, 1fr);
      overflow: visible !important;
    }

    body[data-page="ai"] .card {
      position: relative;
      overflow: hidden;
      border-radius: 16px;
      cursor: pointer;
      display: block;
      background: var(--card);
      color: var(--card-ink);
      transition: transform 0.35s cubic-bezier(.2,.6,.2,1);
      contain: layout paint style;
    }

    body[data-page="ai"] .card.xl { grid-column: span 8; grid-row: span 4; }
    body[data-page="ai"] .card.large { grid-column: span 4; grid-row: span 3; }
    body[data-page="ai"] .card.medium { grid-column: span 4; grid-row: span 2; }
    body[data-page="ai"] .card.small { grid-column: span 4; grid-row: span 2; }

    /* Hover sin desplazar hacia arriba para que la fila superior no se corte */
    body[data-page="ai"] .card:hover {
      transform: translateY(0) scale(1.01);
      transform-origin: center center;
      box-shadow: 0 10px 24px rgba(15,23,42,.12);
    }

    body[data-page="ai"] .card-media { position: relative; height: 100%; }
    body[data-page="ai"] .card-media img {
      width: 100%; height: 100%; object-fit: cover; display: block;
      filter: saturate(1.05) contrast(1.05);
      transform: scale(1.02);
      transform-origin: center center;
      transition: transform 0.5s cubic-bezier(.2,.7,.2,1), filter 0.35s ease;
    }
    /* En hover solo escalamos imagen/overlay sin mover la card hacia arriba */
    body[data-page="ai"] .card:hover .card-media img { transform: scale(1.06); filter: blur(6px) brightness(.92) saturate(.9); will-change: filter, transform; }

    body[data-page="ai"] .card-gradient {
      position: absolute; inset: 0;
      pointer-events: none;
    }
    /* Overlay de información (3 filas: título, subtítulo, iconos) */
    body[data-page="ai"] .card-overlay { position:absolute; inset:0; display:grid; grid-template-rows:auto auto auto; align-content:end; justify-items:start; gap:8px; padding:20px; text-align:left; opacity:0; transform: translateY(16px); transition: opacity .25s ease, transform .25s ease; }
    body[data-page="ai"] .card:hover .card-overlay { opacity:1; transform: translateY(0); }
    body[data-page="ai"] .card-overlay p { margin:0; font-size:14px; }
    body[data-page="ai"] .card-overlay .icons { display:flex; gap:10px; align-items:center; justify-content:flex-start; margin-top:4px; margin-bottom:12px; }
    body[data-page="ai"] .card-overlay .icons svg,
    body[data-page="ai"] .card-overlay .icons img { height:18px; width: auto; opacity:.9; filter: drop-shadow(0 1px 3px rgba(0,0,0,.12)); object-fit: contain; }
    /* Ajustes ópticos por logo para igualar altura visual sin distorsión */
    body[data-page="ai"] .card-overlay .icons img[src*="Cursor AI"] { height:17px; }
    body[data-page="ai"] .card-overlay .icons img[src*="Google_Gemini"] { height:17px; }
    body[data-page="ai"] .card-overlay .icons img[src*="us_logo_full"] { height:16px; }

    /* ===== MODAL (namespaced) ===== */
    body[data-page="ai"] .modal-backdrop {
      position: fixed; inset: 0; display: grid; place-items: center;
      background: rgba(0,0,0,0.35);
      backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
      opacity: 0; pointer-events: none; transition: opacity 0.25s ease; z-index: 2000;
    }
    body[data-page="ai"] .modal-backdrop[aria-hidden="false"] { opacity: 1; pointer-events: auto; }

    body[data-page="ai"] .modal {
      width: min(820px, 90%);
      max-height: 90vh;
      border-radius: 18px;
      overflow: auto;
      background: var(--card); color: var(--card-ink);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.06);
      transform: translateY(16px) scale(0.98); opacity: 0;
      transition: transform 0.35s cubic-bezier(.2,.7,.2,1), opacity 0.35s ease;
      padding: 24px; position: relative;
    }
    body[data-page="ai"] .modal-backdrop[aria-hidden="false"] .modal { transform: translateY(0) scale(1); opacity: 1; }
    body[data-page="ai"] .modal h2 { margin-top: 0; }
    body[data-page="ai"] .modal img { width: 100%; border-radius: 12px; margin-bottom: 16px; }
    body[data-page="ai"] .modal-close {
      position: absolute; top: 16px; right: 16px;
      background: transparent; border: none; color: var(--card-ink); font-size: 28px; cursor: pointer;
    }

    /* ===== Responsive ===== */
    @media (max-width: 980px) {
      body[data-page="ai"] .grid { grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(8, 1fr); }
      body[data-page="ai"] .card.xl { grid-column: span 6; grid-row: span 4; }
      body[data-page="ai"] .card.large { grid-column: span 6; grid-row: span 3; }
      body[data-page="ai"] .card.medium { grid-column: span 3; grid-row: span 2; }
      body[data-page="ai"] .card.small { grid-column: span 3; grid-row: span 1; }
    }
    @media (max-width: 560px) {
      body[data-page="ai"] main { padding: 6px; }
      body[data-page="ai"] .grid { gap: 6px; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(12, 1fr); }
      body[data-page="ai"] .card.xl { grid-column: span 4; grid-row: span 5; }
      body[data-page="ai"] .card.large { grid-column: span 4; grid-row: span 4; }
      body[data-page="ai"] .card.medium { grid-column: span 4; grid-row: span 2; }
      body[data-page="ai"] .card.small { grid-column: span 4; grid-row: span 1; }
      
      /* ===== EXPANSIÓN EN MÓVIL ===== */
      body[data-page="ai"] .grid.has-expanded {
        display: block !important;
        height: auto !important;
        max-height: none !important;
        overflow: visible !important;
        gap: 16px;
      }

      body[data-page="ai"] .grid.has-expanded > .card {
        display: none !important;
        grid-column: auto !important;
        grid-row: auto !important;
      }

      body[data-page="ai"] .grid.has-expanded > .card.is-expanded {
        display: block !important;
        width: 100% !important;
        min-height: calc(100vh - 120px);
        grid-column: 1 / -1 !important;
        grid-row: auto !important;
      }
    }

    /* AI page: configuración de padding para main */
    body[data-page="ai"] main {
      padding: 16px;      /* si quieres menos "aire", baja este valor, p. ej. 12px */
    }

    /* La grid: full-bleed, sin max-width ni márgenes centrados */
    body[data-page="ai"] .grid {
      margin: 0 !important;
      max-width: none !important;
      width: 100%;
      height: 100%;
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(12, 1fr);
      grid-template-rows: repeat(6, 1fr);
      grid-auto-flow: dense; /* rellena huecos si puede */
    }

    /* Evita "saltos" de imagen inline y problemas de encogimiento */
    body[data-page="ai"] .card { min-width: 0; min-height: 0; }
    body[data-page="ai"] .card-media img { display: block; width: 100%; height: 100%; object-fit: cover; }

    /* Estado base: solo cuando NO hay expansión */
    body[data-page="ai"] .grid[data-state="base"] > .card:nth-child(1) {  /* JS Web */
      grid-column: 1 / span 4;
      grid-row: 1 / span 3;
    }
    body[data-page="ai"] .grid[data-state="base"] > .card:nth-child(2) {  /* Make.com Automatizaciones */
      grid-column: 5 / span 4;
      grid-row: 1 / span 3;
    }
    body[data-page="ai"] .grid[data-state="base"] > .card:nth-child(3) {  /* CNAPP Survival */
      grid-column: 9 / span 4;
      grid-row: 1 / span 3;
    }
    body[data-page="ai"] .grid[data-state="base"] > .card:nth-child(4) {  /* Contenidos RRSS */
      grid-column: 1 / span 6;
      grid-row: 4 / span 3;
    }
    body[data-page="ai"] .grid[data-state="base"] > .card:nth-child(5) {  /* Amazon AI */
      grid-column: 7 / span 6;
      grid-row: 4 / span 3;
    }

    /* ===== Expandable Grid (add-on) ===== */
    body[data-page="ai"] .grid {
      grid-auto-flow: dense;              /* empaqueta huecos automáticamente */
      transition: grid-gap .25s ease;
    }

    body[data-page="ai"] .card {
      /* spans controlados por variables, con transición suave */
      --col-span: 3;                      /* base: como ya tenías */
      --row-span: 1;
      grid-column: span var(--col-span);
      grid-row: span var(--row-span);
      transition:
        transform .35s cubic-bezier(.2,.6,.2,1),
        filter .25s ease,
        opacity .25s ease;
      position: relative;
      isolation: isolate;
    }

    /* tus "large" siguen funcionando igual */
    body[data-page="ai"] .card.large { --col-span: 6; --row-span: 1; }

    /* Estado expandido de UNA card */
    body[data-page="ai"] .card.is-expanded {
      --col-span: 8;                      /* ocupa 8/12 columnas */
      --row-span: 2;                      /* y 2 filas (toda la altura del grid) */
      z-index: 3;
      transform: translateY(-2px) scale(1.01);
    }

    /* El resto se encoge pero quedan visibles y rellenan el grid */
    body[data-page="ai"] .grid.has-expanded .card:not(.is-expanded) {
      --col-span: 2;                      /* mínimo 2 columnas */
      --row-span: 1;                      /* 1 fila (mínimo de alto) */
      opacity: .95;
      filter: saturate(.9) contrast(.95) brightness(.96);
      transform: scale(.985);
    }

    /* Contenidos extra: solo visibles al expandir */
    body[data-page="ai"] .card-extra {
      display: none;
      opacity: 0;
      transition: opacity .25s ease;
    }
    body[data-page="ai"] .card.is-expanded .card-extra {
      display: block;
      opacity: 1;
    }

    body[data-page="ai"] .card.is-expanded .card-body {
      /* un poco más de aire al texto al expandir */
      padding: 18px 18px 20px;
    }

    /* Mini-galería dentro de la expandida */
    body[data-page="ai"] .gallery {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      padding-bottom: 6px;
      margin-top: 10px;
    }
    body[data-page="ai"] .gallery img {
      height: 120px;
      min-width: 200px;
      object-fit: cover;
      border-radius: 10px;
      scroll-snap-align: start;
    }

      /* Responsivo: en pantallas estrechas la expandida ocupa todo */
      @media (max-width: 980px) {
        body[data-page="ai"] .card.is-expanded { --col-span: 12; --row-span: 2; }
        body[data-page="ai"] .grid.has-expanded .card:not(.is-expanded) { --col-span: 6; }
      }
      @media (max-width: 560px) {
        body[data-page="ai"] .card.is-expanded { --col-span: 4; --row-span: 2; }
        body[data-page="ai"] .grid.has-expanded .card:not(.is-expanded) { --col-span: 4; }
      }

      /* ===== EXPAND FIX: anular posiciones fijas cuando haya una expandida ===== */

      /* Valores por defecto de las variables (sirven solo en modo expandido) */
      body[data-page="ai"] .card {
        --col-span: 4;   /* base en expand mode */
        --row-span: 2;
      }

      /* Cuando hay una expandida, TODOS los items dejan de usar las posiciones fijas
         y pasan a usar únicamente los span por variables */
      body[data-page="ai"] .grid.has-expanded > .card {
        grid-column: span var(--col-span) !important;
        grid-row: span var(--row-span) !important;
      }

      /* La expandida crece */
      body[data-page="ai"] .grid.has-expanded > .card.is-expanded {
        --col-span: 8;   /* ocupa ~2/3 del ancho (12 columnas totales) */
        --row-span: 4;   /* más alto; tu grid tiene 6 filas */
        z-index: 3;
        transform: translateY(-2px) scale(1.01);
      }

      /* Las no-expandidas se encogen pero siguen visibles (mínimo 2×2) */
      body[data-page="ai"] .grid.has-expanded > .card:not(.is-expanded) {
        --col-span: 2;
        --row-span: 2;
        opacity: .96;
        filter: saturate(.9) contrast(.95) brightness(.96);
        transform: scale(.985);
      }

      /* No difuminar la imagen de la expandida */
      body[data-page="ai"] .card.is-expanded .card-media img {
        filter: none !important;
        transform: scale(1.02);
      }

      /* Mostrar contenido extra solo en expandida (ya lo tenías, lo refuerzo) */
      body[data-page="ai"] .card-extra { display: none; opacity: 0; transition: opacity .25s ease; }
      body[data-page="ai"] .card.is-expanded .card-extra { display: block; opacity: 1; }

      /* Responsivo opcional del expand:
         - En tablet que la expandida ocupe todo el ancho.
         - En móvil no usamos expand (tu JS ya lo evita), pero lo dejo por si fuerza. */
      @media (max-width: 980px) {
        body[data-page="ai"] .grid.has-expanded > .card.is-expanded { --col-span: 12; --row-span: 4; }
        body[data-page="ai"] .grid.has-expanded > .card:not(.is-expanded) { --col-span: 6; --row-span: 2; }
      }
      @media (max-width: 560px) {
        body[data-page="ai"] .grid.has-expanded > .card.is-expanded { --col-span: 4; --row-span: 3; }
        body[data-page="ai"] .grid.has-expanded > .card:not(.is-expanded) { --col-span: 4; --row-span: 2; }
      }

      /* === GRID EXPANDIBLE – LAYOUTS POR ESTADO === */

      /* El grid base ya lo tienes. Añadimos estados del grid
         con data-state en el contenedor .grid */
      body[data-page="ai"] .grid {
        position: relative;
        contain: layout paint style; /* rendimiento */
      }

      /* --- Base (ya lo tienes) ---
         1: 8x3   2: 4x3
         3: 4x3   4: 8x3
      */
      body[data-page="ai"] .grid > .card:nth-child(1) { grid-column: 1 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid > .card:nth-child(2) { grid-column: 5 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid > .card:nth-child(3) { grid-column: 9 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid > .card:nth-child(4) { grid-column: 1 / span 6; grid-row: 4 / span 3; }
      body[data-page="ai"] .grid > .card:nth-child(5) { grid-column: 7 / span 6; grid-row: 4 / span 3; }

      /* Cards encogidas cuando hay expandida */
      body[data-page="ai"] .grid[data-state^="expand-"] > .card {
        transition: transform .35s cubic-bezier(.2,.7,.2,1), filter .25s ease, opacity .25s ease;
        will-change: transform, filter;
      }
      body[data-page="ai"] .grid[data-state^="expand-"] > .card:not(.is-expanded) {
        transform: scale(.96);
        filter: brightness(.95) contrast(.95) saturate(.95);
      }

      /* Contenido extra: visible solo en expandida */
      body[data-page="ai"] .card .card-extra { display: none; opacity: 0; transition: opacity .25s ease; }
      body[data-page="ai"] .card.is-expanded .card-extra { display: block; opacity: 1; }
      body[data-page="ai"] .card.is-expanded .card-body { padding: 18px; }

      /* === Reglas básicas para expansión === */
      body[data-page="ai"] .grid[data-state^="expand-"] > .card {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative !important;
        min-width: 100px !important;
        min-height: 100px !important;
      }

      /* === Disposiciones por card expandida (12x6) === */
      /* 1) Expande la #1 (JS Web) → margen derecho 4 items en filas enteras */
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(1) { grid-column: 1 / span 8; grid-row: 1 / span 12; }
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(2) { grid-column: 9 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(3) { grid-column: 9 / span 4; grid-row: 4 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(4) { grid-column: 9 / span 4; grid-row: 7 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(5) { grid-column: 9 / span 4; grid-row: 10 / span 3; }

      /* 2) Expande la #2 (Make.com) */
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(2) { grid-column: 1 / span 8; grid-row: 1 / span 12; }
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(1) { grid-column: 9 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(3) { grid-column: 9 / span 4; grid-row: 4 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(4) { grid-column: 9 / span 4; grid-row: 7 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(5) { grid-column: 9 / span 4; grid-row: 10 / span 3; }

      /* 3) Expande la #3 (CNAPP) */
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(3) { grid-column: 1 / span 8; grid-row: 1 / span 12; }
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(1) { grid-column: 9 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(2) { grid-column: 9 / span 4; grid-row: 4 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(4) { grid-column: 9 / span 4; grid-row: 7 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(5) { grid-column: 9 / span 4; grid-row: 10 / span 3; }

      /* 4) Expande la #4 (Contenidos RRSS) */
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(4) { grid-column: 1 / span 8; grid-row: 1 / span 12; }
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(1) { grid-column: 9 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(2) { grid-column: 9 / span 4; grid-row: 4 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(3) { grid-column: 9 / span 4; grid-row: 7 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(5) { grid-column: 9 / span 4; grid-row: 10 / span 3; }

      /* 5) Expande la #5 (Amazon AI) */
      body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(5) { grid-column: 1 / span 8; grid-row: 1 / span 12; }
      body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(1) { grid-column: 9 / span 4; grid-row: 1 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(2) { grid-column: 9 / span 4; grid-row: 4 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(3) { grid-column: 9 / span 4; grid-row: 7 / span 3; }
      body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(4) { grid-column: 9 / span 4; grid-row: 10 / span 3; }

      /* Tablet: mantenemos la idea, pero con 6 columnas */
      @media (max-width: 980px) and (min-width: 560px) {
        /* base compacta */
        body[data-page="ai"] .grid { grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(12, 1fr); }
        body[data-page="ai"] .grid > .card:nth-child(1) { grid-column: 1 / span 4; grid-row: 1 / span 3; }
        body[data-page="ai"] .grid > .card:nth-child(2) { grid-column: 5 / span 2; grid-row: 1 / span 3; }
        body[data-page="ai"] .grid > .card:nth-child(3) { grid-column: 1 / span 2; grid-row: 4 / span 2; }
        body[data-page="ai"] .grid > .card:nth-child(4) { grid-column: 3 / span 2; grid-row: 4 / span 2; }
        body[data-page="ai"] .grid > .card:nth-child(5) { grid-column: 5 / span 2; grid-row: 4 / span 2; }

        /* expand-1 (4 items a la derecha en filas enteras) */
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(1) { grid-column: 1 / span 4 !important; grid-row: 1 / span 12 !important; }
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(2) { grid-column: 5 / span 2 !important; grid-row: 1 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(3) { grid-column: 5 / span 2 !important; grid-row: 4 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(4) { grid-column: 5 / span 2 !important; grid-row: 7 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-1"] > .card:nth-child(5) { grid-column: 5 / span 2 !important; grid-row: 10 / span 3 !important; }

        /* expand-2 */
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(2) { grid-column: 1 / span 4 !important; grid-row: 1 / span 12 !important; }
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(1) { grid-column: 5 / span 2 !important; grid-row: 1 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(3) { grid-column: 5 / span 2 !important; grid-row: 4 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(4) { grid-column: 5 / span 2 !important; grid-row: 7 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-2"] > .card:nth-child(5) { grid-column: 5 / span 2 !important; grid-row: 10 / span 3 !important; }

        /* expand-3 */
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(3) { grid-column: 1 / span 4 !important; grid-row: 1 / span 12 !important; }
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(1) { grid-column: 5 / span 2 !important; grid-row: 1 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(2) { grid-column: 5 / span 2 !important; grid-row: 4 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(4) { grid-column: 5 / span 2 !important; grid-row: 7 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-3"] > .card:nth-child(5) { grid-column: 5 / span 2 !important; grid-row: 10 / span 3 !important; }

        /* expand-4 */
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(4) { grid-column: 1 / span 4 !important; grid-row: 1 / span 12 !important; }
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(1) { grid-column: 5 / span 2 !important; grid-row: 1 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(2) { grid-column: 5 / span 2 !important; grid-row: 4 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(3) { grid-column: 5 / span 2 !important; grid-row: 7 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-4"] > .card:nth-child(5) { grid-column: 5 / span 2 !important; grid-row: 10 / span 3 !important; }

        /* expand-5 */
        body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(5) { grid-column: 1 / span 4 !important; grid-row: 1 / span 12 !important; }
        body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(1) { grid-column: 5 / span 2 !important; grid-row: 1 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(2) { grid-column: 5 / span 2 !important; grid-row: 4 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(3) { grid-column: 5 / span 2 !important; grid-row: 7 / span 3 !important; }
        body[data-page="ai"] .grid[data-state="expand-5"] > .card:nth-child(4) { grid-column: 5 / span 2 !important; grid-row: 10 / span 3 !important; }
      }

      /* En móvil seguimos usando tu modal — no expandimos dentro del grid */

      /* --- Overlay SIEMPRE anclado abajo (hover y expandida) --- */
      body[data-page="ai"] .card-overlay{
        position: absolute;
        left: 16px;
        right: 16px;
        bottom: 16px;
        top: auto;                 /* <- importante: ya no arriba */
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
        padding: 0;
        text-align: left;
        opacity: 0;
        transform: translateY(8px);
        transition: opacity .25s ease, transform .25s ease;
        z-index: 2;                /* por encima del blur */
      }

      /* Degradado para legibilidad (debajo del texto, encima del blur) */
      body[data-page="ai"] .card-overlay::before{
        content: "";
        position: absolute;
        left: -16px;              /* pequeño "bleed" para cubrir borde */
        right: -16px;
        bottom: -16px;
        height: 55%;
        background: var(--overlay-grad-light);
        z-index: -1;
        pointer-events: none;
      }

      /* Mostrar overlay en hover (todas las cards) */
      body[data-page="ai"] .card:hover .card-overlay{
        opacity: 1;
        transform: translateY(0);
      }

      /* En expandida: overlay SIEMPRE visible (sin depender del hover) */
      body[data-page="ai"] .card.is-expanded .card-overlay{
        opacity: 1;
        transform: none;
      }

      /* Sin pastilla - contenido directo */
      body[data-page="ai"] .card-overlay .overlay-head{
        display: flex;
        flex-direction: column;
        gap: 6px;
        max-width: min(520px, 80%);
        padding: 0;
      }

      body[data-page="ai"] .card-overlay .overlay-head p{
        margin: 2px 0 6px 0;
        font-size: 14px;
        color: var(--muted);
      }
      body[data-page="ai"] .card-overlay .overlay-head .icons{
        display: flex;
        gap: 10px;
        align-items: center;
      }

      /* Bloque extra (desc + CTA) SOLO cuando está expandida */
      body[data-page="ai"] .overlay-extra{
        display: none;
        opacity: 0;
        transition: opacity .25s ease;
        max-width: min(680px, 86%);
        align-self: flex-start;
        margin-top: 14px;
      }
      body[data-page="ai"] .card.is-expanded .overlay-extra{
        display: flex;
        flex-direction: column;
        gap: 10px;
        opacity: 1;
        align-items: flex-start;
      }

      /* Descriptivo + CTA */
      body[data-page="ai"] .overlay-desc{
        margin: 0;
        font-size: 14px;
        line-height: 1.6;
        color: var(--muted);
      }

      body[data-page="ai"] .overlay-cta{
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 14px;
        border-radius: 12px;
        border: 1px solid rgba(255,255,255,0.4);
        background: rgba(255,255,255,0.1);
        color: #ffffff;
        font-weight: 400;
        text-decoration: none;
        width: fit-content;
        transition: transform .18s ease, background .18s ease, border-color .18s ease, box-shadow .18s ease;
        pointer-events: auto; /* permite clic por encima de la capa de expansión */
        z-index: 3;           /* asegura que quede por encima visualmente */
      }
      body[data-page="ai"] .overlay-cta:hover{
        transform: translateY(-2px);
        background: rgba(255,255,255,0.3);
        border-color: rgba(255,255,255,0.8);
        box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        cursor: pointer;
      }
      body[data-page="ai"] .overlay-cta:active{
        transform: translateY(0);
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      }
      body[data-page="ai"] .overlay-cta svg{ width:16px; height:16px; color: #ffffff; fill: #ffffff; }

      /* La imagen en expandida, oscura para legibilidad, pero SIN mover overlay */
      body[data-page="ai"] .card.is-expanded .card-media img{
        filter: blur(8px) brightness(.98) saturate(.9);
        transform: none;
      }
      body[data-page="ai"] .card.is-expanded:hover .card-media img{
        filter: blur(8px) brightness(.98) saturate(.9);
      }
      
      /* ===== AI Corner: overlay y colores solo en hover/expandida ===== */

      /* Apaga cualquier gradiente/overlay existente por defecto */
      body[data-page="ai"] .card-gradient,
      body[data-page="ai"] .card-overlay {
        pointer-events: none; /* el overlay no interfiere con clicks */
      }
      /* Asegura que el gradiente preexistente no sea visible por defecto */
      body[data-page="ai"] .card-gradient { background: none !important; display: none; }
      /* Desactiva cualquier degradado claro anterior del propio overlay */
      body[data-page="ai"] .card .card-overlay::before { background: none !important; }

      /* Capa de gradiente propia (negro -> transparente, desde abajo) */
      body[data-page="ai"] .card .card-media::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          to top,
          rgba(0,0,0,0.80) 0%,
          rgba(0,0,0,0.50) 28%,
          rgba(0,0,0,0.00) 62%
        );
        opacity: 0;               /* oculto por defecto */
        transition: opacity .28s ease;
        pointer-events: none;
        z-index: 1;               /* por encima de la imagen, debajo del texto */
      }

      /* El bloque de texto del overlay solo se muestra en hover/expandida */
      body[data-page="ai"] .card .card-overlay {
        opacity: 0;
        transform: translateY(10px);
        transition: opacity .22s ease, transform .22s ease;
        z-index: 2;
      }

      /* Hover o expandida = overlay visible */
      body[data-page="ai"] .card:hover .card-media::after,
      body[data-page="ai"] .card.is-expanded .card-media::after {
        opacity: 1;
      }
      body[data-page="ai"] .card:hover .card-overlay,
      body[data-page="ai"] .card.is-expanded .card-overlay {
        opacity: 1;
        transform: translateY(0);
      }

      /* Colores de textos al activarse el overlay */
      body[data-page="ai"] .card:hover .card-overlay h3,
      body[data-page="ai"] .card.is-expanded .card-overlay h3 {
        color: #fff !important;
      }
      body[data-page="ai"] .card:hover .card-overlay p,
      body[data-page="ai"] .card.is-expanded .card-overlay p {
        color: #e6e6e6 !important;
      }
      /* para descripciones más largas si existen dentro del overlay */
      body[data-page="ai"] .card:hover .card-overlay .overlay-desc,
      body[data-page="ai"] .card.is-expanded .card-overlay .overlay-desc {
        color: #cfcfcf !important;
      }

      /* Sombras: apagadas por defecto, solo en hover/expandida */
      body[data-page="ai"] .card { box-shadow: none !important; }
      body[data-page="ai"] .card:hover,
      body[data-page="ai"] .card.is-expanded { box-shadow: 0 18px 44px rgba(0,0,0,.22); }

      /* Mantén la imagen legible con overlay, sin duplicar blur en hover */
      body[data-page="ai"] .card:hover .card-media img,
      body[data-page="ai"] .card.is-expanded .card-media img {
        filter: brightness(0.95) contrast(1.02) !important;
      }

      /* ===== Menu overlay: ajustes tipográficos y sociales ===== */
      body[data-page="ai"] .menu-overlay .menu-links a{
        text-transform: none !important; /* no mayúsculas */
        font-size: 18px;                 /* un poco más pequeño */
        letter-spacing: -0.01em;
      }
      body[data-page="ai"] .menu-panel .menu-divider{
        height: 1px;
        background: var(--stroke);
        margin: 12px 0;
      }
      body[data-page="ai"] .menu-panel .menu-social{
        display: flex;
        gap: 12px;
        padding-top: 4px;
      }
      body[data-page="ai"] .menu-panel .menu-social a{
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 36px; height: 36px;
        border-radius: 10px;
        border: 1px solid var(--stroke);
        background: var(--fill-soft);
        color: var(--text);
        transition: transform .18s ease, background .18s ease, border-color .18s ease;
      }
      body[data-page="ai"] .menu-panel .menu-social a:hover{
        transform: translateY(-1px);
        background: var(--fill-soft);
        border-color: var(--stroke);
      }
      body[data-page="ai"] .menu-panel .menu-social svg{ width:18px; height:18px; }
      body[data-page="ai"] .menu-panel .menu-social .menu-lang{
        margin-left: auto;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 44px; height: 36px;
        border-radius: 10px;
        border: 1px solid var(--stroke);
        background: var(--fill-soft);
        color: var(--text);
        font-weight: 700;
        letter-spacing: .02em;
        cursor: pointer;
        transition: transform .18s ease, background .18s ease, border-color .18s ease;
      }
      body[data-page="ai"] .menu-panel .menu-social .menu-lang:hover{
        transform: translateY(-1px);
        background: var(--fill-soft);
        border-color: var(--stroke);
      }
  </style>
</head>

<body data-page="ai">
  <!-- ===== NAV (igual que about.html) ===== -->
  <nav class="site-nav">
    <div class="nav-inner">
      <div class="menu-bar">
        <a class="menu-logo" href="./index.html">
          <img src="assets/cursors/JS_GRIS.svg" alt="JS" />
          <span class="logo-mask" aria-hidden="true"></span>
        </a>

        <button class="menu-toggle" id="menuToggle" aria-label="Open menu">
          <input type="checkbox" aria-hidden="true" tabindex="-1" />
          <div class="bars"><span></span><span></span></div>
        </button>
      </div>
      <div class="right-links"></div>
    </div>
  </nav>

  <div class="menu-overlay" id="menuOverlay" aria-hidden="true">
    <div class="menu-panel" id="menuPanel">
      <nav class="menu-links" aria-label="Primary">
        <a href="./work.html" data-i18n="menu.work">Work</a>
        <a href="./about.html" data-i18n="menu.about">About</a>
        <a href="./ai-corner.html" data-i18n="menu.ai">AI Lab</a>
      </nav>
      <div class="menu-divider" role="separator" aria-hidden="true"></div>
      <div class="menu-social" aria-label="Social links">
        <a href="https://www.instagram.com/jon_sagarminaga/" target="_blank" rel="noopener" aria-label="Instagram"
           title="Instagram">
          <!-- Instagram icon -->
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7zm5 3.5A5.5 5.5 0 1 1 6.5 13 5.5 5.5 0 0 1 12 7.5zm0 2A3.5 3.5 0 1 0 15.5 13 3.5 3.5 0 0 0 12 9.5zM17.8 6.2a1 1 0 1 1-1.6 1.2 1 1 0 0 1 1.6-1.2z"/>
          </svg>
        </a>
        <a href="https://www.linkedin.com/in/jon-sagarminaga-erkoreka/" target="_blank" rel="noopener" aria-label="LinkedIn"
           title="LinkedIn">
          <!-- LinkedIn icon -->
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1s2.48 1.12 2.48 2.5zM.5 8h4V23h-4V8zm7 0h3.8v2.05h.05c.53-1 1.83-2.05 3.77-2.05 4.03 0 4.78 2.65 4.78 6.1V23h-4v-7.3c0-1.74-.03-3.98-2.43-3.98-2.44 0-2.82 1.9-2.82 3.86V23h-4V8z"/>
          </svg>
        </a>
        <button type="button" id="langToggle" class="menu-lang" aria-label="Toggle language" title="Language toggle">EN</button>
      </div>
    </div>
  </div>

  <!-- ===== GRID ===== -->
  <main>
    <section class="grid" aria-label="AI Experiments grid" id="aiGrid">
      <!-- Card 1 - JS Web — Vibe Coding -->
      <article class="card" data-id="js-web">
        <div class="card-media">
          <img src="assets/Projects/JS/JS_Portrait.png" alt="JS Web — Vibe Coding Portfolio" loading="lazy" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <!-- Cabecera fija: title / subtitle / icons -->
          <div class="overlay-head">
            <h3 data-i18n="card.jsweb.title">JS Web — Vibe Coding</h3>
            <p data-i18n="card.jsweb.subtitle">Portfolio personal desarrollado íntegramente con inteligencia artificial</p>
            <div class="icons" aria-hidden="true">
              <img src="assets/IACorner/Logos/chatgptblanco@2x.png" alt="ChatGPT" loading="lazy" />
              <img src="assets/IACorner/Logos/cursor@2x.png" alt="Cursor.ai" loading="lazy" />
              <img src="assets/IACorner/Logos/Gemini@2x.png" alt="Google Gemini" loading="lazy" />
              <img src="assets/IACorner/Logos/unicorn@2x.png" alt="Unicorn Studio" loading="lazy" />
            </div>
          </div>

          <!-- Extra SOLO visible en expandida -->
          <div class="overlay-extra">
            <p class="overlay-desc" data-i18n="card.jsweb.overlayShort">
              Portfolio creado como experimento técnico y creativo, combinando diseño, prompting y desarrollo asistido por IA.
            </p>
            <div style="margin-top: 12px; display: flex; flex-direction: column; gap: 8px;">
              <p data-i18n="card.jsweb.long1">"JS Web – Vibe Coding" es un proyecto personal que explora el potencial del desarrollo web potenciado por IA.</p>
              <p data-i18n="card.jsweb.long2">Todo el proceso —desde la concepción visual hasta la estructura de código— ha sido guiado mediante prompting en ChatGPT, integrando Cursor.ai como entorno de desarrollo y coordinación del flujo de trabajo.</p>
              <p data-i18n="card.jsweb.long3">Algunas imágenes y recursos visuales se generaron con Nano Banana, y para efectos de presentación interactiva y motion se utilizó Unicorn.studio.</p>
              <p data-i18n="card.jsweb.long4">El resultado es una web dinámica, moderna y coherente visualmente, donde el diseño, la tecnología y la IA se integran para expresar una nueva forma de crear digitalmente.</p>
            </div>
            <a class="overlay-cta" href="./index.html" target="_blank" rel="noopener" style="margin-top: 12px;">
              <span class="cta-label" data-i18n="cta.more">Ver más detalle</span>
              <!-- flecha ↗ -->
              <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M14 5h5v5h-2V8.41l-8.29 8.3-1.42-1.42 8.3-8.29H14V5z"/>
              </svg>
            </a>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title" data-i18n="card.jsweb.title">JS Web — Vibe Coding</h3>
          <p class="card-desc" data-i18n="card.jsweb.subtitle">Portfolio personal desarrollado íntegramente con inteligencia artificial</p>
          <div class="card-extra">
            <p>"JS Web – Vibe Coding" es un proyecto personal que explora el potencial del desarrollo web potenciado por IA.</p>
            <p>Todo el proceso —desde la concepción visual hasta la estructura de código— ha sido guiado mediante prompting en ChatGPT, integrando Cursor.ai como entorno de desarrollo y coordinación del flujo de trabajo.</p>
            <p>Algunas imágenes y recursos visuales se generaron con Nano Banana, y para efectos de presentación interactiva y motion se utilizó Unicorn.studio.</p>
            <p>El resultado es una web dinámica, moderna y coherente visualmente, donde el diseño, la tecnología y la IA se integran para expresar una nueva forma de crear digitalmente.</p>
            <p><strong>ChatGPT · Cursor.ai · Nano Banana · Unicorn.studio</strong></p>
            <div class="gallery">
              <img src="assets/Projects/JS/JS_Portrait.png" alt="JS Web — Vibe Coding Home" loading="lazy">
              <img src="assets/Projects/JS/JS_1.png" alt="JS Web — Vibe Coding About" loading="lazy">
              <img src="assets/Projects/JS/JS_2.png" alt="JS Web — Vibe Coding Work" loading="lazy">
            </div>
          </div>
        </div>
      </article>

      <!-- Card 2 - Make.com Automatizaciones -->
      <article class="card large" data-id="make-automation">
        <div class="card-media">
          <img src="assets/IACorner/Make/BG_Login.png" alt="Make.com Automatizaciones" loading="lazy" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <!-- Cabecera fija: title / subtitle / icons -->
          <div class="overlay-head">
            <h3 data-i18n="card.make.title">Automatizaciones Make.com</h3>
            <p data-i18n="card.make.subtitle">Generación automática de contenidos para Instagram y X.</p>
            <div class="icons" aria-hidden="true">
              <img src="assets/IACorner/Logos/makeblanco@2x.png" alt="Make.com" loading="lazy" />
              <img src="assets/IACorner/Logos/chatgptblanco@2x.png" alt="ChatGPT" loading="lazy" />
            </div>
          </div>

          <!-- Extra SOLO visible en expandida -->
          <div class="overlay-extra">
            <p class="overlay-desc" data-i18n="card.make.overlayShort">
              Automatización completa de contenido para redes sociales usando Make.com. Generación automática de posts para Instagram y X con programación inteligente.
            </p>
            <a class="overlay-cta" href="https://x.com/CisneNegroApp" target="_blank" rel="noopener">
              <span class="cta-label" data-i18n="cta.more">Ver más detalle</span>
              <!-- flecha ↗ -->
              <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M14 5h5v5h-2V8.41l-8.29 8.3-1.42-1.42 8.3-8.29H14V5z"/>
              </svg>
            </a>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title" data-i18n="card.make.title">Automatizaciones Make.com</h3>
          <p class="card-desc" data-i18n="card.make.subtitle">Generación automática de contenidos para Instagram y X.</p>

          <!-- SOLO visible cuando la card está expandida -->
          <div class="card-extra">
            <p>Automatización completa de contenido para redes sociales usando Make.com. Incluye generación automática de posts, programación inteligente, integración con APIs de redes sociales y flujos de trabajo personalizados para maximizar el engagement.</p>
            <div class="gallery" aria-label="Galería">
              <img src="assets/IACorner/Make/BG_Login.png" alt="Make.com Interface" loading="lazy">
              <img src="assets/IACorner/Make/BG_Login.png" alt="Automation Workflow" loading="lazy">
              <img src="assets/IACorner/Make/BG_Login.png" alt="Social Media Integration" loading="lazy">
            </div>
          </div>
        </div>
      </article>

      <!-- Card 2 - CNAPP Survival App -->
      <article class="card" data-id="cnapp-survival">
        <div class="card-media">
          <img src="assets/IACorner/CNAPP/Icon3.png" alt="CNAPP Survival App" loading="lazy" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <!-- Cabecera fija: title / subtitle / icons -->
          <div class="overlay-head">
            <h3 data-i18n="card.cnapp.title">CNAPP Survival</h3>
            <p data-i18n="card.cnapp.subtitle">App de supervivencia con Lovable.</p>
            <div class="icons" aria-hidden="true">
              <img src="assets/IACorner/Logos/chatgptblanco@2x.png" alt="ChatGPT" loading="lazy" />
              <img src="assets/IACorner/Logos/lovable@2x.png" alt="Lovable" loading="lazy" />
            </div>
          </div>

          <!-- Extra SOLO visible en expandida -->
          <div class="overlay-extra">
            <p class="overlay-desc" data-i18n="card.cnapp.overlayShort">
              Aplicación de supervivencia desarrollada con Lovable, plataforma de desarrollo con IA. Experiencia completa de supervivencia en situaciones extremas.
            </p>
            <a class="overlay-cta" href="https://black-swan-preparedness-hub.lovable.app/?utm_source=lovable-editor" target="_blank" rel="noopener">
              <span class="cta-label" data-i18n="cta.more">Ver más detalle</span>
              <!-- flecha ↗ -->
              <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M14 5h5v5h-2V8.41l-8.29 8.3-1.42-1.42 8.3-8.29H14V5z"/>
              </svg>
            </a>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title" data-i18n="card.cnapp.title">CNAPP Survival</h3>
          <p class="card-desc" data-i18n="card.cnapp.subtitle">App de supervivencia con Lovable.</p>
          <div class="card-extra">
            <p>Aplicación de supervivencia desarrollada con Lovable, plataforma de desarrollo con IA. Incluye guías de supervivencia, técnicas de primeros auxilios, navegación, construcción de refugios y preparación para situaciones extremas.</p>
            <div class="gallery">
              <img src="assets/IACorner/CNAPP/Icon3.png" alt="CNAPP App Icon" loading="lazy">
              <img src="assets/IACorner/CNAPP/Icon3.png" alt="CNAPP Interface" loading="lazy">
            </div>
          </div>
        </div>
      </article>

      <!-- Card 3 - Contenidos RRSS -->
      <article class="card large" data-id="rrss-content">
        <div class="card-media">
          <img src="assets/Projects/VPO/Computer Screen Mockup copia.jpg" alt="Contenidos RRSS con ChatGPT" loading="lazy" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <!-- Cabecera fija: title / subtitle / icons -->
          <div class="overlay-head">
            <h3 data-i18n="card.rrss.title">Contenidos RRSS</h3>
            <p data-i18n="card.rrss.subtitle">ChatGPT entrenado con datos empresariales.</p>
            <div class="icons" aria-hidden="true">
              <img src="assets/IACorner/Logos/Gemini@2x.png" alt="Google Gemini" loading="lazy" />
              <img src="assets/IACorner/Logos/chatgptblanco@2x.png" alt="ChatGPT" loading="lazy" />
            </div>
          </div>

          <!-- Extra SOLO visible en expandida -->
          <div class="overlay-extra">
            <p class="overlay-desc" data-i18n="card.rrss.overlayShort">
              ChatGPT personalizado entrenado con datos específicos de la empresa para generar temas, desarrollar contenidos y proponer ideas de ilustración para redes sociales.
            </p>
            <a class="overlay-cta" href="https://www.linkedin.com/company/vpo-ingenieria" target="_blank" rel="noopener">
              <span class="cta-label" data-i18n="cta.more">Ver más detalle</span>
              <!-- flecha ↗ -->
              <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M14 5h5v5h-2V8.41l-8.29 8.3-1.42-1.42 8.3-8.29H14V5z"/>
              </svg>
            </a>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title" data-i18n="card.rrss.title">Contenidos RRSS</h3>
          <p class="card-desc" data-i18n="card.rrss.subtitle">ChatGPT entrenado con datos empresariales.</p>
          <div class="card-extra">
            <p>ChatGPT personalizado entrenado con datos específicos de la empresa para generar temas relevantes, desarrollar contenidos adaptados al tono corporativo y proponer ideas creativas para ilustraciones. Incluye estrategias de contenido, calendario editorial y propuestas visuales personalizadas.</p>
            <div class="gallery">
              <img src="assets/Projects/VPO/Computer Screen Mockup copia.jpg" alt="ChatGPT Interface" loading="lazy">
              <img src="assets/Projects/VPO/Computer Screen Mockup copia.jpg" alt="Content Strategy" loading="lazy">
            </div>
          </div>
        </div>
      </article>

      <!-- Card 5 - Amazon AI Project -->
      <article class="card medium" data-id="amazon-ai">
        <div class="card-media">
          <img src="assets/IACorner/Amazon/370 - copia.png" alt="Amazon AI generated images project" loading="lazy" />
          <div class="card-gradient"></div>
        </div>
        <div class="card-overlay">
          <!-- Cabecera fija: title / subtitle / icons -->
          <div class="overlay-head">
            <h3 data-i18n="card.amazon.title">Amazon AI Series</h3>
            <p data-i18n="card.amazon.subtitle">Consistencia visual con IA temprana.</p>
            <div class="icons" aria-hidden="true">
              <img src="assets/IACorner/Logos/chatgptblanco@2x.png" alt="ChatGPT" loading="lazy" />
              <img src="assets/IACorner/Logos/Gemini@2x.png" alt="Google Gemini" loading="lazy" />
            </div>
          </div>

          <!-- Extra SOLO visible en expandida -->
          <div class="overlay-extra">
            <p class="overlay-desc" data-i18n="card.amazon.overlayShort">
              Proyecto pionero de generación de imágenes con IA de hace más de un año, cuando lograr consistencia visual era un verdadero desafío técnico.
            </p>
            <a class="overlay-cta" href="https://www.amazon.es/Mandalas-Wild-Animals-Color-Enjoy/dp/B0DHZ8QGH7/ref=pd_rhf_dp_s_ci_mcx_mr_hp_d_d_sccl_2_2/257-1385953-9691753?pd_rd_w=M9zQc&content-id=amzn1.sym.7cab37f0-9f91-4fec-abf5-398309e3ac94:amzn1.symc.206c6295-3b43-4a2b-9d15-273ba17f7025&pf_rd_p=7cab37f0-9f91-4fec-abf5-398309e3ac94&pf_rd_r=BK8KZ3M9GVPVS18XW6GG&pd_rd_wg=ZWNfF&pd_rd_r=2a98b6d6-50d8-4832-93d7-7fe56d061c55&pd_rd_i=B0DHZ8QGH7&psc=1" target="_blank" rel="noopener">
              <span class="cta-label" data-i18n="cta.more">Ver más detalle</span>
              <!-- flecha ↗ -->
              <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M14 5h5v5h-2V8.41l-8.29 8.3-1.42-1.42 8.3-8.29H14V5z"/>
              </svg>
            </a>
          </div>
        </div>
        <div class="card-body">
          <h3 class="card-title" data-i18n="card.amazon.title">Amazon AI Series</h3>
          <p class="card-desc" data-i18n="card.amazon.subtitle">Consistencia visual con IA temprana.</p>
          <div class="card-extra">
            <p>Proyecto pionero de generación de imágenes con IA de hace más de un año, cuando lograr consistencia visual era un verdadero desafío técnico. Exploración de las capacidades tempranas de la IA generativa.</p>
            <div class="gallery">
              <img src="assets/IACorner/Amazon/Book - copia.png" alt="Amazon Book AI" loading="lazy">
              <img src="assets/IACorner/Amazon/contra - copia.png" alt="Amazon Contra AI" loading="lazy">
              <img src="assets/IACorner/Amazon/Cuadro - copia.png" alt="Amazon Cuadro AI" loading="lazy">
            </div>
          </div>
        </div>
      </article>
    </section>
  </main>

  <!-- ===== MODAL ===== -->
  <div class="modal-backdrop" aria-hidden="true">
    <div class="modal">
      <button class="modal-close" aria-label="Close">&times;</button>
      <h2>Título del proyecto</h2>
      <img src="" alt="" hidden>
      <p>Aquí irá más información detallada del proyecto seleccionado.</p>
    </div>
  </div>

  <!-- ===== JS menú (igual que about) + modal dinámico ===== -->
  <script>
    (function(){
      const toggle = document.getElementById('menuToggle');
      const overlay = document.getElementById('menuOverlay');
      const panel = document.getElementById('menuPanel');
      const bar = document.querySelector('.menu-bar');
      const logo = document.querySelector('.menu-logo');
      const logoImg = logo?.querySelector('img');
      const logoMask = logo?.querySelector('.logo-mask');

      if (toggle && overlay) {
        const setOpen = (open) => {
          overlay.classList.toggle('open', open);
          overlay.setAttribute('aria-hidden', String(!open));
          document.body.style.overflow = open ? 'hidden' : '';
        };
        const positionPanel = () => {
          if (!bar || !panel) return;
          const rect = bar.getBoundingClientRect();
          const top = rect.bottom + 24 + window.scrollY;
          panel.style.top = top + 'px';
          panel.style.left = '';
          panel.style.transform = '';
        };
        toggle.addEventListener('click', (e) => {
          e.preventDefault();
          const checkbox = toggle.querySelector('input');
          const open = checkbox ? !checkbox.checked : !overlay.classList.contains('open');
          setOpen(open);
          toggle.classList.toggle('open', open);
          if (checkbox) checkbox.checked = open;
          if (open) positionPanel();
        });
        const closeAndReset = () => {
          setOpen(false);
          toggle.classList.remove('open');
          const c = toggle.querySelector('input');
          if (c) c.checked = false;
        };
        overlay.addEventListener('click', (e) => { if (e.target === overlay) closeAndReset(); });
        overlay.querySelectorAll('a').forEach(a => a.addEventListener('click', closeAndReset));
        window.addEventListener('resize', () => { if (overlay.classList.contains('open')) positionPanel(); });
      }

      function randomGradient(){
        const h = Math.floor(Math.random()*360);
        const h2 = (h+60)%360;
        return `linear-gradient(135deg, hsl(${h} 80% 65%), hsl(${h2} 80% 65%))`;
      }
      function applyRandomGradient(){
        if (!logoMask || !logoImg) return;
        logoMask.style.background = randomGradient();
        logoMask.classList.add('gradient');
        logoImg.style.opacity = '0';
      }
      function removeGradient(){
        if (!logoMask || !logoImg) return;
        logoMask.classList.remove('gradient');
        logoImg.style.opacity = '1';
      }
      logo?.addEventListener('mouseenter', applyRandomGradient);
      logo?.addEventListener('mouseleave', removeGradient);
    })();

    /* ===== COMENTADO: Sistema anterior de expansión ===== */
    /*
    (function () {
      // ------- helpers modal -------
      const backdrop = document.querySelector('.modal-backdrop');
      const modal    = backdrop?.querySelector('.modal');
      const closeBtn = modal?.querySelector('.modal-close');
      const h2       = modal?.querySelector('h2');
      const p        = modal?.querySelector('p');
      const img      = modal?.querySelector('img');

      const openModal = ({ title, desc, image }) => {
        if (!backdrop) return;
        if (h2)  h2.textContent = title || 'Proyecto';
        if (p)   p.textContent  = desc  || '';
        if (img) {
          if (image) { img.src = image; img.alt = title || ''; img.hidden = false; }
          else { img.hidden = true; }
        }
        backdrop.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
      };

      const closeModal = () => {
        if (!backdrop) return;
        backdrop.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
      };

      closeBtn?.addEventListener('click', closeModal);
      backdrop?.addEventListener('click', (e) => { if (e.target === backdrop) closeModal(); });
      window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

      // ------- expand/collapse -------
      const grid  = document.getElementById('aiGrid');
      const cards = grid ? Array.from(grid.querySelectorAll('.card')) : [];

      const collapseAll = () => {
        grid?.classList.remove('has-expanded');
        cards.forEach(c => c.classList.remove('is-expanded'));
      };

      // ------- selector de modo por width -------
      const mqMobile = window.matchMedia('(max-width: 560px)');

      function attachHandlers() {
        // Limpia listeners antiguos si recargas esta función
        cards.forEach(card => {
          const clone = card.cloneNode(true);
          card.parentNode.replaceChild(clone, card);
        });
        // Vuelve a capturar la lista actualizada
        const freshCards = Array.from(grid.querySelectorAll('.card'));

        freshCards.forEach(card => {
          // Datos para el modal (si no hay data-*, se toman del DOM)
          const getModalData = () => ({
            title: card.dataset.title || card.querySelector('.card-title')?.textContent || 'Proyecto',
            desc : card.dataset.desc  || card.querySelector('.card-desc')?.textContent  || '',
            image: card.dataset.image || card.querySelector('.card-media img')?.getAttribute('src') || ''
          });

          if (mqMobile.matches) {
            // ----- MÓVIL: solo modal -----
            card.addEventListener('click', () => {
              // por si quedaba algo expandido desde un resize
              collapseAll();
              openModal(getModalData());
            });
          } else {
            // ----- DESKTOP/TABLET: solo expandir -----
            card.addEventListener('click', (e) => {
              // no colapsar al interactuar con carruseles dentro
              if (e.target.closest('.gallery')) return;

              const isOpen = card.classList.contains('is-expanded');
              if (isOpen) {
                collapseAll();
              } else {
                freshCards.forEach(c => c.classList.remove('is-expanded'));
                card.classList.add('is-expanded');
                grid.classList.add('has-expanded');
                card.scrollIntoView({ block: 'nearest', inline: 'nearest', behavior: 'smooth' });
              }
            });
          }
        });
      }

      // Ejecutar al cargar
      if (grid && cards.length) attachHandlers();

      // Reaplicar cuando cambie el breakpoint
      mqMobile.addEventListener('change', () => {
        collapseAll();
        attachHandlers();
      });

      // Opcional: al redimensionar muy grande/pequeño, rearmar
      window.addEventListener('resize', () => {
        // nada agresivo, solo asegurar estado coherente
        if (mqMobile.matches) collapseAll();
      });
    })();
    */

    /* ===== NUEVO SISTEMA DE EXPANSIÓN CON FLIP OPTIMIZADO ===== */
    (function(){
      const grid   = document.getElementById('aiGrid');
      if (!grid) return;

      const mqMobile = window.matchMedia('(max-width: 560px)');
      let abortController = null;
      let isAnimating = false;

      // Estado base
      function setBaseState(){
        grid.dataset.state = 'base';
        grid.classList.remove('has-expanded');
        grid.querySelectorAll('.card.is-expanded').forEach(c => c.classList.remove('is-expanded'));
      }

      // Qué estado aplicar según card index (1..5)
      function stateForIndex(idx){
        return `expand-${idx}`;
      }

      // FLIP optimizado: solo anima elementos visibles y usa RAF
      function animateFlip(beforeRects, duration = 400){
        if (isAnimating) return;
        isAnimating = true;
        
        const cards = Array.from(grid.querySelectorAll('.card'));
        const visibleCards = cards.filter(el => {
          const rect = el.getBoundingClientRect();
          return rect.width > 0 && rect.height > 0;
        });

        // Usar requestAnimationFrame para mejor rendimiento
        requestAnimationFrame(() => {
          visibleCards.forEach((el) => {
            const before = beforeRects.get(el);
            if (!before) return;
            
            // Usar RAF para calcular after rect
            requestAnimationFrame(() => {
              const after = el.getBoundingClientRect();
              const dx = before.left - after.left;
              const dy = before.top  - after.top;
              const sx = before.width  / after.width;
              const sy = before.height / after.height;

              const animation = el.animate(
                [
                  { transform: `translate(${dx}px, ${dy}px) scale(${sx}, ${sy})` },
                  { transform: 'translate(0,0) scale(1,1)' }
                ],
                { 
                  duration, 
                  easing: 'cubic-bezier(.2,.7,.2,1)', 
                  fill: 'both' 
                }
              );
              
              animation.onfinish = () => {
                // Verificar si todas las animaciones terminaron
                const allFinished = Array.from(document.getAnimations()).every(anim => 
                  anim.playState === 'finished' || anim.playState === 'idle'
                );
                if (allFinished) {
                  isAnimating = false;
                }
              };
            });
          });
          
          // Si no hay cards visibles, resetear flag después de un delay
          if (visibleCards.length === 0) {
            setTimeout(() => { isAnimating = false; }, duration);
          }
        });
      }

      // Manejar click en desktop/tablet/mobile (ahora funciona en todos)
      function onCardClick(card, index){
        if (isAnimating) return; // Prevenir clicks durante animación
        
        const wasExpanded = card.classList.contains('is-expanded');
        const beforeRects = new Map();
        
        // Solo calcular rects de cards visibles
        grid.querySelectorAll('.card').forEach(el => {
          const rect = el.getBoundingClientRect();
          if (rect.width > 0 && rect.height > 0) {
            beforeRects.set(el, rect);
          }
        });

        if (wasExpanded) {
          setBaseState();
        } else {
          const newState = stateForIndex(index + 1);
          grid.dataset.state = newState;
          grid.querySelectorAll('.card').forEach(el => el.classList.remove('is-expanded'));
          card.classList.add('is-expanded');
          grid.classList.add('has-expanded');
        }

        // Forzar reflow y animar
        requestAnimationFrame(() => {
          grid.getBoundingClientRect();
          animateFlip(beforeRects, 420);
        });
      }

      // Atar listeners con AbortController (mejor que clonar)
      function bind(){
        // Limpiar listeners anteriores
        if (abortController) {
          abortController.abort();
        }
        abortController = new AbortController();
        const signal = abortController.signal;

        const cards = Array.from(grid.querySelectorAll('.card'));
        
        cards.forEach((card, idx) => {
          // Evita que el CTA dispare la expansión/colapso
          card.querySelectorAll('.overlay-cta').forEach((cta) => {
            cta.addEventListener('click', (e) => {
              e.stopPropagation();
            }, { signal });
          });

          // Ahora funciona en mobile también
          card.addEventListener('click', (e) => {
            if (e.target.closest('.gallery') || e.target.closest('.overlay-cta')) return;
            onCardClick(card, idx);
          }, { signal });
        });
      }

      // Inicializa
      setBaseState();
      bind();

      // Re-bind cuando cambia breakpoint
      mqMobile.addEventListener('change', () => {
        setBaseState();
        bind();
      });

      // Si redimensionan mucho, vuelve a base para evitar estados raros
      let resizeTimeout;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          if (mqMobile.matches) setBaseState();
        }, 150);
      });
    })();
  </script>
</body>
</html>
